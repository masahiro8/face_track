{"version":3,"sources":["components/VideoCanvas.scss","components/AssetsSelectMenu/AssetsSelectMenu.scss","components/Header/Header.scss","icon/baseline_save_white_48dp.png","icon/baseline_favorite_white_48dp.png","icon/baseline_toys_white_48dp.png","icon/baseline_delete_white_48dp.png","icon/baseline_play_circle_outline_white_48dp.png","App.scss","canvas.point.js","components/FaceDetect.jsx","config.js","util/vector.js","components/FaceDetectView.jsx","components/VideoCanvas.jsx","components/scheduleDelegate.js","components/spline.js","components/ani.js","components/AssetLoader.jsx","components/AssetsSelectMenu/AssetsSelectMenu.jsx","icon/Icons.js","components/StampManager/StampManager.jsx","components/Header/Header.jsx","App.js","serviceWorker.js","index.js","components/StampManager/StampManager.scss"],"names":["module","exports","overlayClickable","overlayCanvas","videoimage","List","ListItem","Header","HeaderItem","viewer","setPoint","canvas","pos","col","ctx","getContext","fillStyle","fillRect","x","y","FaceDetect","_Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","pointlog","net","faceapi","state","faceDetect","inherits","createClass","key","value","_componentDidMount","asyncToGenerator","regenerator_default","a","mark","_callee2","_this2","wrap","_context2","prev","next","tinyFaceDetector","load","console","log","setInterval","_callee","_context","predict","stop","interval","apply","arguments","_predict","_callee3","options","result","_context3","abrupt","inputSize","scoreThreshold","video","withFaceLandmarks","sent","setState","react_default","createElement","Component","VIDEO_SIZE","width","height","INTERVAL","Math","floor","PARTS_INDEX","nose","leftEye","rightEye","shiftBase","b","p","toFixed","vectorLength","v","sqrt","dotProduct","crossProduct","distance","p1","p2","pow","FaceDetectView","tilt","deg","radian","star","BASE_PARTS","partsConfig","base","VECTOR_PARTS","vector","positions","Array","assetId","points","nextProps","JSON","stringify","loadData","landmarks","clearCanvas","lowpathFilter","detectTilt","showEyes","editMode","drawPoints","showPoints","drawParts","length","_","point","index","initPointRate","ref","setRef","begin","end","_end","_crossProduct","acos","PI","myPoint","_this3","_begin","_end_vec","vec_length","point_distance","rate","dot","vec","distanceFromCenter","cross","bool","vec2","cos","sin","asset","anies","id","img","sprite","_x","_y","setCanvas","transform","_myPoint","distanceFromEdge","abs","_dotProduct","cos_theta","_a","_b","dotDistance","math","rate_vec_point","rate_from_edge","_point","_points","editCallback","clearRect","_this4","_this5","step","parts","map","concat","getColor","e","rect","getBoundingClientRect","clientX","left","clientY","top","push","_this6","className","styles","onClick","multiPoints","addMultiPoints","addPoint","Video","media","selfRef","initCam","navigator","mediaDevices","getUserMedia","audio","facingMode","size","Promise","resolve","then","stream","srcObject","onloadedmetadata","catch","err","alert","setSelf","autoPlay","playsInline","Canvas","draw","context","drawImage","set","VideoImage","_Component3","_this7","_this8","VideoCanvas_Video","setVideo","VideoCanvas_Canvas","scheduleDelegate","isPlay","time_total","time_start","time_interval","time_current","time_prev","delegate","init","setCurrent","checkCallback","window","requestAnimationFrame","update","bind","time","d","callback","restart","Date","getTime","_current","random","Spline","c","num","prototype","constructor","sp","tmp","i","w","culc","t","dt","j","image","local","rot","move","rotate","emit","getCtx","save","_rot","_pos","cx","cy","setTransform","restore","aniSprite","_sprite","scheduler","frame","schedule","makeFrames","makeSplineFrames","src","playAnims","splineFrames","_anim","anim","rots","val","frames","list","n","r","current","getValuePerFrame","posx","posy","spx","spy","total_frames","_time","tiltFlag","reverse","_frames","_tilt","localMove","localRotate","theta","fpos","_pos_x","_pos_y","undefined","AssetLoader","ani","done","progress","images","assets","loadImage","path","Image","onload","total","view","Fragment","show","AssetsSelectMenu","AssetsSelectMenu_AssetButton","AssetLoader_AssetLoader","GetMenu","AssetButton","_ref","icons","stamps","del","play","StampManager","data","saveAsset","assertThisInitialized","loadAsset","delete","deleteAsset","_asset","currentAsset","newData","parseInt","filtered","StampManager_AssetButton","getAssets","menu","Header_HeaderItem","icon","label","children","alt","App","type","scale","overlay","stampMode","edit","initCanvas","Header_Header_Header","VideoCanvas_VideoImage","FaceDetect_FaceDetect","_faceapi$getMediaDime","resizedResults","res","forSize","jawOutline","getJawOutline","getNose","mouth","getMouth","getLeftEye","getRightEye","leftEyeBrow","getLeftEyeBrow","rightEyeBrow","getRightEyeBrow","getLandmarks","faceLandmarks","FaceDetectView_FaceDetectView","setOverlay","AssetsSelectMenu_AssetsSelectMenu_AssetsSelectMenu","StampManager_StampManager_StampManager","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","serviceWorker","ready","registration","unregister","Save"],"mappings":"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","file":"static/js/main.787c8584.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlayClickable\":\"P2Ozy3EA7iOKnUsuEd04Y\",\"overlayCanvas\":\"_1VTjcrIdjUewwZ-qVkXQxP\",\"videoimage\":\"_27P8rrrUDhjUTuQVCNHvHs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"List\":\"_17OjsATFS6zIy16TMy7zqq\",\"ListItem\":\"_30OCCDeljyP59MV9Um1PQS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Header\":\"_1_1R8koVt7QLbrCdGtt2l0\",\"HeaderItem\":\"_1eoswoDnCHUentPP5rEtLr\"};","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAABl0lEQVR4Ae3YIUiDYRCH8VPQiXzai7OI2ntVQexJzNq1f00sqlHRntSNdVxPW4cN2YzKWDFtj30w9r1zujv4/3p54MLdmYiIiIiMxwYX1Onx13KbPTJeGZLAVQIlmgAQNIEHgLAJbDGAwAlcAgROoAGhE/iG0AmMsBlLSAgaAHn0AMijB0AePQDy6AGQRw+APHoA5NEDmEOAAhSgAAUowIFwAQpQgAIUoAAFKEABClCAAj555JBdMtbY4YhHvuIEvHPKko1gmVM6EQIqrNgYrPDsPeDOJuDGc0CNBZuABapeA7qsWgGs0vUZcGIFceIxoM2iFcQiLX8BN5aAW38BB5aAfX8B25aAbX8B65aAdX8BmSUgm3mARmjfErDnL+DaEnDtL6BtCWj5C4BjK4jj6Mvch88AqBZap2uxD5rb2CdlJcZRf8aSjaDEGZ1Ib5UnjthlbX5vlT6e9C0VDTxpWiqu8OTKUrHJAC8GlC0d93jxYNOgRAMPmpRsOmS8MGSehryQ2W9Q5pw6Pf5bjzfOKZuIiIiIjPUDoNPYrFKF/TUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAACuklEQVR4Ae3WA7AlVxSF4dXzYtu2XYht27ZZjJNCbNsc27btwtjmU/9j47R736n+yjzYVCGoQqFQKBQKBbbhAl6nGbMBmMsI2vEvH/MIuykEducRfqYfVawwi2a8xgVsrXRQxlX8Tzkb4tOBe9lCDmzJPXTCZ0PK+Z8rKVOS2II3mEQQk3lpw49gT95mMkFM4g22UDI4kcGEMZortQ425xPKCWMwJyo+nqSC8L5kK62GI+hPeAt5SnGwJbWIajAHazlOYyZR1WLL6NfvQRyzuViLcQkLiKN7xCfwD3GVcwEXUE5cfyk8XiIJC1hAEl5SOFxANZZUc6GCowbDsKY/NRQU92LRfQqGzRmDRaMDzmbuwap7FAT1saq+3NiOcqwqZzu5cCWWXSEX3sey9+VCAyyrLxcGY9kQuTAVy6bKhXIsWygXFpb6AyZj2US5MALLhsqFdljWWC58VeqD7HEsu0suHIRlu8mNgVjVW0HwJla9qSA4GB+LfA5UMLTColYKimux6DIFhcdArOmsMLgJa05VOHTDkl8VFifhY8U89wCzvRU9pyjYisFY0AlP0XAY88jbXA6Qm+FudIPi4Uvy9KXiYnO6kZfubK742Isx5GEseyoZHM0ssjaLo5QcLqKKLFVyoZLF/WSnmuuUPN4lGz53Kw14/E0WnlRaKMvgCa8pTXj8Spo+V9rw+I60fKcs4PEVafgOT1nhK/u/78DHJOljZY9XSMorygcP4xOXz8PKD7dTTRyV3K58cS0VRFXB5cofFzKfKOZzoWzgTGYT1mzOkB0cywTCmMCxsoX9GElQQ9lP9rAL3QiiGzvKJramNS6t2Vp2sTm12JhabC7b8PiFDfkFT6WAN1ifN1Q6eByf1fk8IMscK0YF16r0cC7zAJjNuSpNnMRkJnOsSheHcqAKhUKhUChsshYBRZ3Amgr4pRAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAACTUlEQVR4Ae3aNXbdUBSF4VOFxhCo7FmYsQy2oXE4TZhpCMY6zEkXbMLRFMIcqfvDKEdrF/c+n7OWvhnsh7q/ZKm1Wi2W0sc2zvEWwGJhmFlK/mBx0McdaiwGujkFEHQAmygh7AAO0MC84ygEHsAOCDyAdRB4ACt4F3vANQg8gPUQe8CD0AMYgtgDZkIPYBll7AFjEHvA3ugDTkUfUEQf8CL6gKodUC8YP73hHBP0s9jy4RkytWDUlMwyZHnwBFlDwVDcoc/S4yQytWA0OE23oz+yesEQfGSzpcQ4Mq1gCA6krZ8lIrVgCI5aOkwj0guGYIelwiAivWBINnT+SKkXDMVbVqZsQgK9YIiuWSqcR1ArGH4+RqxSwxYPSOleh9MiQ6Q2bKmwSxgwQ2ozlg7HaKYXDF3Jso7d4GCMHMYsJbbwkf/ZSw77LC26OMn8TpHDKUuPXm5QV5BDYXkwUjsmviCHF7kfNZjgLG8AqMihEkpDEpXL0oDumcvSgK5wWRrQnXRZGtDtc1ka0I17LA26kmUeS4NuysxjadANmfkrDboH9oW/0qBbb194Kw26i/aNr9Kge8cq+8ZXadCtsR88lQbdTvvFT2nQHbc/eCkNuiP2Fw+lQfeBrfYPB6VBdoouq/FQGhQ36LV5eSsNdZ+Yazom+iwNAK+1gzq6yhZWO+BZ9AFF9AEnow/YF33AeOwBJctiD5gyn1ANxR7wwLxCsz72gIvml14wnNILhlN6wXBKLxhO6QXDKb1gOKUXDKf0guGUXjCcqhWMpFqt1mefsRYz20BHUgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAAs0lEQVR4Ae3PMRGDQAAF0eto0EBMIoAWCYkILCQSwAlDDxsLycC/odhVsK9ckZmZmZkx8GvD/ffzhPx+npDfvxOBygkQcC4BAgRkMjPCCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAg4EYAAQIECBAgQICAjWRbHjCTbMkDRpKNecCDnVQ7XcnHk1SvUiMaZhItNKVOtEwcXNnBRFtqRkfPh5Wzrbzp6YqZmZmZ/d0XPSYAGSNVNd8AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAEmklEQVR4Ae3bQ7zkWBTH8dPPao9t27Z345m2bdtejW3b2rdt1Gvbtuo3numTynvBza2qRb77wsnnn+TiXIlFJxaLxWKcz2N04QV+YDKL2MARDrCRBJP5gRfowmOcK9mIMurwNivxYwXv8AxVJVtwJa+yl6B28zpXSWaRz7NMwMQE6pAvmUBNBrCRKKxnIDUlnahCE7YSpc00pYqkB5cxGRsmc5nYx2Psw5Z9PCY2kcNwvBxiHG/QmYe5mtMpopjTuIpH6MzrjOMQXkZYixJF/EhlyhnM3RR6fMddDKacyvxEkUSP45lKRXYwkiskAC5nFDuoyFRqSbQ4hxW4W0l7SiQESmnHKtwt4RyJDiezCjdJXqXUcAjyKu5WcUp04SnHzRrukQhwD6twk+AEMUcRM3HzNdUkIlTnc9zMpEhM8ZJrdNpJxOhAklQviRnuI1WSBmIBTVxLeEDC4zg2k6q5WEILUm3iOAmLD0nVUyyiF6k+kHC4i1QvimU8T6q7JTjyWIbTb1RJw1D9F5yWki9B0QancsrSNL9O4NQm+PVfh5b0N9rhPYrFEFeRRFtOngRBY5zeEF+ABVwshngTp0YSBAm0nRznuwDYRx3j4ctOtIT4x504DRKf+IdplBiE0x3iFx+g7aZG0AJMo0QNdod8H1DKAbQx4hv/MI8SY9D2+xy68zhO5wQvwDxKnIfT4+IHL6LNlABQzKLEzFDjAOai9TAowChKdEebK96ohdMVBgUYRYkrcKolXrgXbbsEgmIaJbah3Rt8DPSVQQHGUeJLtDbBh7ODjAswiBKD0J4XL/yGVse4AIMoUQftN/HCHLTrjQswiBLXo80RL6xAO9u4AIMocTbaiuD3/XHGBRhEiePRtokXkmhFxgUYRIkitKPihYNoBVYL8JimUIB2ULywJasidBzaFvHC8jTdxB+HuomXB3+M3mChgL00svcY/Q2tbkZfZHXRfhUvvIA2RAIxjo7C0OBDiXYWBnMqOkaDubbihQeyaji9He1+8UJtSxOajyOZ0JSJN2ajdZcADKOj0A1ttvjBC2jTMjapn472QlqWVQyio3BO2GWVUvajjRbfjKKjMBrtAKXiD+9l5dLie+IXd+A0WHxS0THAEJxuN1terym+6OgYXP8daAnTDY7X07rB8TpOjSUI8liLluQq8UFFJySuIIm2jjwJhnY4JdK2yVeOU7swPaGLcPqFHLGMHH7DaRF5Ehy3RNt8YdBccrOEwwek6iUW0du01UDhODaltdmjGak2c5yExwOkStJELKA5SVLdZ6fhqYNEjHZg5Z6jiBnWW86q8TVuZlAk5qhNAjdruFsiwN2swU2C2hINTqmw7fIV47bLl83bLk0bX9uGbHwtoQ2rcLeCc7O79fgKj9bj4zPR/L2EIZ7N38XczVCWUJkfKRI7qOKr/X48b9Dln/b7Eoo5/Z/2+zcYzyG8DKeK2MST7LV6AMI+LrF2BOUS8RYfAvoHNRlo+RiWfeRTl4mYmEhd8iWzuIrX2RPqKOLlki2oSh3eMj8Mmj3HcX/87zjuQTaSYAo/8iJdeIzzJTKxWCwWi/0OGaOdH89+l7kAAAAASUVORK5CYII=\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viewer\":\"_2jJlzIwcKi4BhGPBAPRaxa\"};","import * as faceapi from \"face-api.js/dist/face-api.js\";\r\n\r\nexport const setPoint = ( canvas , pos  , col) =>{\r\n  const ctx = canvas.getContext(\"2d\");\r\n  ctx.fillStyle = col||\"#0ff\";\r\n  ctx.fillRect(pos.x,pos.y,4,4);\r\n}\r\n\r\nexport const getLandmarks = (landmarks) => {\r\n  const jawOutline = landmarks.getJawOutline();\r\n  const nose = landmarks.getNose();\r\n  const mouth = landmarks.getMouth();\r\n  const leftEye = landmarks.getLeftEye();\r\n  const rightEye = landmarks.getRightEye();\r\n  const leftEyeBrow = landmarks.getLeftEyeBrow();\r\n  const rightEyeBrow = landmarks.getRightEyeBrow();\r\n  return {\r\n    nose:nose,\r\n    mouth:mouth,\r\n    leftEye:leftEye,\r\n    rightEye:rightEye,\r\n    leftEyeBrow:leftEyeBrow,\r\n    rightEyeBrow:rightEyeBrow,\r\n    jawOutline:jawOutline,\r\n  }\r\n}\r\n\r\nexport const resizeCanvasAndResults = (dimensions, canvas, results) => {\r\n  const { width, height } = dimensions instanceof HTMLVideoElement\r\n    ? faceapi.getMediaDimensions(dimensions)\r\n    : dimensions\r\n  canvas.width = width\r\n  canvas.height = height\r\n\r\n  // resize detections (and landmarks) in case displayed image is smaller than\r\n  // original size\r\n  return results.map(res => res.forSize(width, height))\r\n}\r\n\r\nexport const drawDetections = (dimensions, canvas, detections)=> {\r\n  console.log(\"drawDetections\" ,detections);\r\n  const resizedDetections = resizeCanvasAndResults(dimensions, canvas, detections)\r\n  faceapi.drawDetection(canvas, resizedDetections)\r\n}\r\n\r\nexport const drawLandmarks = (dimensions, canvas, results, withBoxes = true) => {\r\n  \r\n  const resizedResults = resizeCanvasAndResults(dimensions, canvas, results)\r\n  console.log(\"drawLandmarks = \",resizedResults);\r\n  if (withBoxes) {\r\n    faceapi.drawDetection(canvas, resizedResults.map(det => det.detection))\r\n  }\r\n\r\n  const faceLandmarks = resizedResults.map(det => det.landmarks)\r\n  const drawLandmarksOptions = {\r\n    lineWidth: 2,\r\n    drawLines: true,\r\n    color: 'green'\r\n  }\r\n  faceapi.drawLandmarks(canvas, faceLandmarks, drawLandmarksOptions)\r\n}","import React, { Component } from \"react\";\nimport * as _ from \"lodash\";\nimport * as faceapi from \"face-api.js/dist/face-api.js\";\nimport { constant } from \"@tensorflow/tfjs-layers/dist/exports_initializers\";\nimport {setPoint,getLandmarks } from '../canvas.point';\n\n// tiny_face_detector options\nlet inputSize = 128\nlet scoreThreshold = 0.5\n\nexport class FaceDetect extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = null;\n    this.pointlog = null;\n    this.net = new faceapi.FaceLandmark68TinyNet();\n    this.state = {\n      faceDetect: {},\n    };\n  }\n\n  async componentDidMount() {\n\n    //必要なモデルのロード\n    await faceapi.nets.tinyFaceDetector.load('models/face/');\n    await faceapi.loadFaceLandmarkModel('models/face/');\n    console.log(\"load models\");\n    setInterval(async () => {\n      await this.predict();\n    }, this.props.interval);\n  }\n\n  async predict() {\n    if (!this.props.canvas) return;\n    //検出\n    let inputSize = 128;\n    let scoreThreshold = 0.5;\n    const options = new faceapi.TinyFaceDetectorOptions({ inputSize, scoreThreshold })\n    const result = await faceapi.detectSingleFace(this.props.video, options).withFaceLandmarks();\n    //console.log(\"predict result\" ,result);\n    if (result) {\n      //console.log(\"result \" , result );\n      // const { width, height } = faceapi.getMediaDimensions(this.props.video);\n      // const resizedResults = [result].map(res => res.forSize(width, height));\n      this.setState({ faceDetect: result });\n      this.props.result(result);\n    }\n  }\n\n  render() {\n    return (\n      <div/>\n    );\n  }\n}","export const location = 'https://192.168.100.109:3000/';\n\nexport const VIDEO_SIZE = {\n  width:640,\n  height:480,\n}\nexport const INTERVAL =  Math.floor(1000/30);\n\n//追従するパーツ\nexport const PARTS_INDEX = {\n  nose :30,\n  leftEye :38,\n  rightEye :44,\n} //[30,38,44]; // 鼻 左目　右目","    //原点補正\n    export const shiftBase = ( b ,p ) =>{\n      return {x:(p.x-b.x).toFixed(2),y:(p.y-b.y).toFixed(2)};\n    }\n    //ベクトル長さ\n    export const vectorLength =(v)=>{\n      return Math.sqrt( v.x * v.x + v.y * v.y);\n      //return Math.pow( ( v.x * v.x ) + ( v.y * v.y ), 0.5 );\n    }\n    //内積\n    export const dotProduct = (a,b) =>{\n      return a.x * b.x + a.y * b.y;\n    }\n\n    //外積\n    export const crossProduct = ( p , v ) =>{\n      return p.x * v.y - v.x * p.y;\n    }\n\n    //ベクトルのなす角(ラジアン)\n    //http://www.sousakuba.com/Programming/gs_two_vector_angle.html\n    //https://qiita.com/vkgtaro/items/b2cd00f376c427cb9ea6\n    export const theta = ( a, b ) => {\n      const _a = vectorLength(a);\n      const _b = vectorLength(b);\n      return Math.cos(dotProduct(a,b) / ( _a * _b ));\n    }\n\n    //ベクトル座標 座標,ベクトル\n    export const vecPos = (p,v) => {\n      return {x:p.x/v,y:p.y*v};\n    }\n    //２点間の距離\n    export const distance = (p1, p2) => {\n      return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n    };\n\n    //原点(0,0)からx軸の傾き\n    export const tilt = ( a ) => {\n      return a.x / vectorLength(a);\n    }","import React, { Component } from \"react\";\nimport * as _ from 'lodash';\nimport math from 'mathjs';\nimport { VIDEO_SIZE } from '../config';\nimport * as vector from '../util/vector';\nimport {setPoint } from '../canvas.point';\nimport styles from './VideoCanvas.scss';\n\n\nexport class FaceDetectView extends Component {\n  constructor(props){\n    super(props);\n    this.canvas = null;\n    this.tilt = null;\n    this.deg = null;\n    this.radian = null;\n    this.star = null;\n\n    //検出対象のパーツ番号\n    this.BASE_PARTS = this.props.partsConfig.base;\n    this.VECTOR_PARTS = this.props.partsConfig.vector;\n\n    //ローパスフィルタ用\n    this.positions = Array.apply(null,new Array(68));\n    this.positions[this.VECTOR_PARTS] = {x:0,y:0};\n    this.positions[this.BASE_PARTS] = {x:0,y:0};\n\n    this.state ={\n      assetId:null,\n      points:[],\n      tilt:null,\n    };\n  }\n\n  componentWillReceiveProps(nextProps){\n\n    //ロードされたデータ\n    if( JSON.stringify(nextProps.loadData) !== JSON.stringify(this.props.loadData)) {\n      console.log(\"points\" , this.state.points);\n      let points = this.state.points;\n      points[0] = nextProps.loadData;\n      this.setState({\n        points:points,\n        assetId:nextProps.loadData.assetId,\n      });\n    }\n\n    if(nextProps.landmarks) {\n      this.clearCanvas();\n\n      //平均化ローパスフィルタ\n      if( this.props.positions ) {\n        this.positions[this.VECTOR_PARTS] = this.lowpathFilter(this.props.positions[this.VECTOR_PARTS] , nextProps.positions[this.VECTOR_PARTS]);\n        this.positions[this.BASE_PARTS]   = this.lowpathFilter(this.props.positions[this.BASE_PARTS] , nextProps.positions[this.BASE_PARTS]);\n      }else {\n        //通常\n        this.positions[this.VECTOR_PARTS] = nextProps.positions[this.VECTOR_PARTS];\n        this.positions[this.BASE_PARTS]   = nextProps.positions[this.BASE_PARTS];\n      }\n\n      this.detectTilt(this.positions[this.VECTOR_PARTS],this.positions[this.BASE_PARTS]);\n\n      if(this.props.showEyes || this.props.editMode ) this.drawPoints();\n      if(this.props.showPoints ) this.drawParts();\n      if(this.state.points.length) {\n        _.each ( this.state.points ,  ( point , index ) =>{\n          this.initPointRate( point,index ,this.positions[this.BASE_PARTS] , this.positions[this.VECTOR_PARTS]);\n          this.setPoint(point,index ,this.positions[this.BASE_PARTS] , this.positions[this.VECTOR_PARTS]);\n        })\n      }\n    }\n\n  }\n\n  setCanvas ( ref ) {\n    this.canvas = ref;\n    this.props.setRef(ref);\n  }\n\n  //ローパス\n  lowpathFilter (prev,next) {\n    return {\n      x:(prev.x*0.9)+(next.x*0.1),\n      y:(prev.y*0.9)+(next.y*0.1),\n    }\n  }\n\n  //傾き検出\n  detectTilt ( begin , end ){\n    //原点をbeginとして補正\n    const _begin = { x:0 , y: 0};\n    const _end = vector.shiftBase( begin , end);\n    //なす角\n    const _crossProduct = vector.crossProduct(_end,{x:100,y:0});\n    this.radian = Math.acos(vector.tilt(_end));\n    this.deg = this.radian*(180/Math.PI);\n    this.tilt = _crossProduct<0?this.radian:-this.deg*(Math.PI/180);\n  }\n\n  //描画\n  setPoint ( myPoint, index , begin, end ) {\n\n    //原点をbeginとして補正\n    const _begin = { x:0 , y: 0};\n    const _end = vector.shiftBase( begin , end);\n    //ベクトル距離\n    const _end_vec = vector.vectorLength(_end);\n    //begin > end 距離\n    const vec_length = vector.distance(_begin , _end);\n    //線上の距離\n    const point_distance = vec_length*myPoint.rate.dot;\n    const vec = {\n      x : ( _begin.x+_end.x/_end_vec*point_distance ) + begin.x,\n      y : ( _begin.y+_end.y/_end_vec*point_distance ) + begin.y\n    }\n    //半径\n    const distanceFromCenter = vec_length*myPoint.rate.cross;\n    const r = myPoint.bool.cross?270:90;\n    const radian = r*Math.PI/180;\n    const vec2 = {\n      x:distanceFromCenter * Math.cos(radian) + vec.x,\n      y:distanceFromCenter * Math.sin(radian) + vec.y,\n    }\n    \n    //仮で画像描画\n    const asset = _.filter(this.props.anies,(asset)=>{return asset.id==this.state.assetId})\n    if( asset.length ) {\n      const img = asset[0].sprite.img;\n      let _x = vec2.x - (img.width/2);\n      let _y = vec2.y - (img.height/2);\n      asset[0].sprite.setCanvas(this.canvas).transform(\n        {x:_x , y:_y},\n        this.tilt,\n        -this.tilt,\n      );\n    }\n\n    if( this.props.editMode ) {\n      setPoint( this.canvas , {x:vec2.x , y:vec2.y} , `rgba(255,255,255)`);\n    }\n\n  }\n\n  //初期値\n  initPointRate( myPoint, index , begin, end ) {\n\n    if ( myPoint.rate ) return;\n\n    //原点をbeginとして補正\n    const _begin = { x:0 , y: 0};\n    const _end = vector.shiftBase( begin , end);\n    const _myPoint = vector.shiftBase( begin ,myPoint.vector);\n    \n    //外積\n    const _crossProduct = vector.crossProduct(_end,_myPoint);\n    const distanceFromEdge = Math.abs(_crossProduct/vector.distance(_begin , _end));//頂点から|begin|endへの距離\n\n    //内積\n    const _dotProduct = vector.dotProduct(_end,_myPoint);// _dotProduct<0 -> 正\n    const cos_theta = vector.theta(_end,_myPoint);\n    const _theta = math.acos(cos_theta);//θ\n    const dotDistance = _theta*vector.vectorLength(_myPoint);//内積 -> 絶対値なので正負の判定を入れる必要がある\n\n    //割合\n    const vec_length = vector.distance(_begin , _end);\n    const rate_vec_point = dotDistance/vec_length;//正しい\n    const rate_from_edge = distanceFromEdge/vec_length;\n\n    //初期値を設定\n    let _point = this.state.points[index];\n    _point.bool = {\n      dot : _dotProduct<0?false:true,\n      cross : _crossProduct<0?true:false,\n    }\n    _point.rate = {\n      dot : _dotProduct<0?-rate_vec_point:rate_vec_point,\n      cross : rate_from_edge,\n    }\n\n    let _points =  this.state.points;\n    _points[index] =  _.clone(_point);\n    this.setState({\n      points:_points,\n    })\n\n    //編集モード\n    if(this.props.editMode){\n      _point.assetId = this.state.assetId;\n      this.props.editCallback(_point);\n    }\n  }\n\n  //キャンバスをクリア\n  clearCanvas () {\n    const context = this.canvas.getContext(\"2d\");\n    context.clearRect(0, 0, VIDEO_SIZE.width, VIDEO_SIZE.height);\n  }\n\n  //ベースパーツを描画\n  drawPoints (){\n    let index = 0;\n    _.each ( this.props.positions ,  point =>{\n      if(index == this.BASE_PARTS) {\n        setPoint( this.canvas , {x:point.x , y:point.y} , `rgba(255,0,0)`);\n      }\n      if(index == this.VECTOR_PARTS) {\n        setPoint( this.canvas , {x:point.x , y:point.y} , `rgba(0,255,0)`);\n      }\n      index++;\n    });\n  }\n\n  //検出したパーツ\n  drawParts () {\n    let landmarks = this.props.landmarks;\n    // パーツごとに色分け\n    const getColor = ( col , index ) =>{\n      let cols = [\n        `rgb(255,${index},${index})`,\n        `rgb(${index},255,${index})`,\n        `rgb(${index},${index},255)`,\n        `rgb(255,255,${index})`,//左目\n        `rgb(${index},255,255)`,//右目\n        `rgb(255,${index},255)`,\n        `rgb(${index},${index},${index})`,\n      ]\n      return cols[col];\n    }\n\n    let col = 0;//パーツインデックス\n    let index = 0;//パーツ内インデックス\n    let step = Math.floor(255/10);//色の段階\n    _.each(landmarks ,( parts , key )=> {\n      col++;\n      index = 0;\n      parts.map ( point => {\n        index++;\n        setPoint( this.canvas , {x:point.x , y:point.y} , getColor(col , index*step ));\n      })\n    })\n    \n  }\n\n  //ポイントを追加\n  addPoint (e) {\n    var rect = this.canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    let _points = this.state.points;\n    _points[0] = {\n      vector:{x:x,y:y},\n      rate:null,\n    };\n    this.setState({\n      points : _points\n    });\n    console.log(\"setpoint\" , _points);\n  }\n\n  //ポイントを追加（複数モード）\n  addMultiPoints (e) {\n    var rect = this.canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    let _points = this.state.points;\n    _points.push({\n      vector:{x:x,y:y},\n      rate:null,\n    });\n    this.setState({\n      points : _points\n    });\n  }\n\n  render(){\n    return(\n      <canvas\n        ref={ref => {\n          this.setCanvas(ref);\n        }}\n        width={VIDEO_SIZE.width}\n        height={VIDEO_SIZE.height}\n        className = {styles[\"overlayCanvas\"]}\n        onClick = {(e)=>{\n          if( this.props.multiPoints ) {\n            this.addMultiPoints(e);\n          }else {\n            this.addPoint(e);\n          }\n        }}\n      />\n    )\n  }\n}\n","import React, { Component } from \"react\";\nimport styles from './VideoCanvas.scss';\nimport {VIDEO_SIZE} from '../config';\n\nclass Video extends Component {\n  constructor(props) {\n    super(props);\n    this.media = null;\n    this.selfRef = null;\n  }\n\n  async componentDidMount() {\n    await this.initCam();\n    //console.log(\"detect init\");\n  }\n\n  async initCam() {\n\n    // const stream = await navigator.mediaDevices.getUserMedia({ video: {} }) \n    this.media = navigator.mediaDevices.getUserMedia({\n      audio: false,\n      video: {\n        // facingMode: \"environment\",\n        facingMode: \"user\",\n        width: this.props.size.width, \n        // height: this.props.size.height,\n      },\n    });\n\n    let p = new Promise( resolve =>{\n      this.media.then(stream => {\n        this.selfRef.srcObject = stream;\n        this.selfRef.onloadedmetadata = function(e) {\n          //console.log(\"Onload video\" , e);\n          resolve();\n        };\n      });\n      \n      this.media.catch(err => {\n        alert(err);\n      });\n    });\n\n    return p;\n    \n  }\n\n  render() {\n    return (\n      <video\n        ref={ref => {\n          this.selfRef = ref;\n          this.props.setSelf(ref);\n        }}\n        className=\"video\"\n        autoPlay\n        playsInline\n        width={VIDEO_SIZE.width}\n        height={VIDEO_SIZE.height}\n      />\n    );\n  }\n}\n\nclass Canvas extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = null;\n  }\n\n  componentDidMount() {\n    setInterval(() => {\n      this.draw();\n    }, this.props.interval);\n  }\n\n  draw() {\n    if (!this.props.video || !this.props.canvas) {\n      return;\n    }\n    let rect = this.props.video.getBoundingClientRect();\n    var context = this.canvas.getContext(\"2d\");\n    this.canvas.width = this.props.size.width;\n    this.canvas.height = this.props.size.height;\n    context.drawImage(\n      this.props.video,0, 0,\n      this.props.size.width,\n      this.props.size.height);\n  }\n\n  render() {\n    return (\n      <canvas\n        ref={ref => {\n          this.canvas = ref;\n          this.props.set(ref);\n        }}\n        id={\"canvas\"}\n        className=\"canvas\"\n      />\n    );\n  }\n}\n\nexport class VideoImage extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      video: null,\n      canvas: null,\n    };\n  }\n\n  setVideo(ref) {\n    if (this.state.video !== ref && ref) {\n      this.setState({ video: ref });\n      this.props.video(ref);\n    }\n  }\n\n  setCanvas(ref) {\n    if (this.state.canvas !== ref && ref) {\n      this.setState({ canvas: ref });\n      this.props.canvas(ref);\n    }\n  }\n\n  render(){\n    return(\n      <div className={styles[\"videoimage\"]}>\n        <Video\n          size = {this.props.size}\n          setSelf={ref => {\n            this.setVideo(ref);\n          }}\n        />\n        <Canvas\n          size = {this.props.size}\n          video={this.state.video}\n          set={ref => {\n            this.setCanvas(ref);\n          }}\n          interval={this.props.interval}\n        />\n      </div>\n    )\n  }\n}","import * as _ from 'lodash';\nexport class scheduleDelegate {\n  constructor(){\n    this.isPlay = false;\n\n    this.time_total = null;\n    this.time_start =  null;\n    this.time_interval = null;\n    this.time_current = null;\n    this.time_prev = null;\n\n    this.delegate = [];\n    this.init();\n  }\n\n  init(){\n    //console.log(\"init schedule delegate\");\n  }\n\n  update () {\n    if( this.isPlay ) {\n      //ここに実装\n      this.setCurrent();\n      this.checkCallback(this.time_total);\n      // console.log(\"total = \", this.time_total/1000);\n    }\n    window.requestAnimationFrame(this.update.bind(this));\n  }\n\n  checkCallback(time) {\n    if(  !this.delegate.length ) return;\n    //コールバックを取り出す\n    let delegate = _.filter( this.delegate , ( value )=>{\n      return value.time == Math.floor(time/1000);\n    });\n    //コールバックを削除する\n    this.delegate = _.reject( this.delegate , ( value )=>{\n      return value.time == Math.floor(time/1000);\n    });\n    _.each ( delegate  , d =>{\n      d.callback();\n    })\n  }\n\n  start () {\n    this.time_total = 0;\n    this.restart();\n    this.update();\n  }\n\n  restart () {\n    this.time_start = new Date().getTime();\n    this.time_current = new Date().getTime();\n    this.time_prev = new Date().getTime();\n    this.time_interval = 0;\n    this.isPlay = true;\n  }\n\n  pause () {\n    this.isPlay = false;\n  }\n\n  /**\n   * 時間の更新\n   */\n  setCurrent() {\n    const _current =  new Date().getTime();\n    this.time_current = _current - this.time_start;\n    this.time_interval = _current  - this.time_prev;\n    this.time_total += this.time_interval;\n    this.time_prev = _current;\n  }\n\n  setCallback(  value  ) {\n    this.delegate.push({\n      time : value.time,\n      callback : value.callback,\n    })\n  }\n}","var cos    = Math.cos,\nsin    = Math.sin,\nabs    = Math.abs,\nPI     = Math.PI,\nfloor  = Math.floor,\nrandom = Math.random;\n \n export function Spline() {\n    this.a = [];\n    this.b = [];\n    this.c = [];\n    this.d = [];\n\n    this.num = 0;\n}\nSpline.prototype = {\n    constructor: Spline,\n    num: 0,\n    a: null,\n    b: null,\n    c: null,\n    d: null,\n    init: function (sp) {\n        var tmp;\n        var w = [];\n        var i;\n\n        this.num = sp.length - 1;\n        var num = this.num;\n\n        var a = this.a;\n        var b = this.b;\n        var c = this.c;\n        var d = this.d;\n\n        // 3次多項式の0次係数(a)を設定\n        for(i = 0; i <= num; i++) {\n            a[i] = sp[i];\n        }\n\n        // 3次多項式の2次係数(c)を計算\n        c[0] = c[num] = 0.0;\n        for(i = 1; i < num; i++) {\n            c[i] = 3.0 * (a[i - 1] - 2.0 * a[i] + a[i + 1]);\n        }\n\n        // 左下を消す\n        w[0] = 0.0;\n        for(i = 1; i < num; i++) {\n            tmp = 4.0 - w[i - 1];\n            c[i] = (c[i] - c[i - 1]) / tmp;\n            w[i] = 1.0 / tmp;\n        }\n\n        // 右上を消す\n        for(i = num - 1; i > 0; i--) {\n            c[i] = c[i] - c[i + 1] * w[i];\n        }\n\n        // 3次多項式の1次係数(b)と3次係数(b)を計算\n        b[num] = d[num] = 0.0;\n        for (i = 0; i < num; i++) {\n            d[i] = (c[i + 1] - c[i]) / 3.0;\n            b[i] = a[i + 1] - a[i] - c[i] - d[i];\n        }\n    },\n\n    // 媒介変数(0～num - 1の実数）に対する値を計算\n    culc: function (t) {\n        var j = floor(t);\n        var dt;\n        var num = this.num;\n\n        var a = this.a;\n        var b = this.b;\n        var c = this.c;\n        var d = this.d;\n\n        if (j < 0) {\n            j = 0;\n        }\n        else if (j >= num) {\n            j = num - 1; // 丸め誤差を考慮\n        }\n\n        dt = t - j;\n\n        return a[j] + (b[j] + (c[j] + d[j] * dt) * dt ) * dt;\n    }\n};","import * as _ from 'lodash';\nimport {scheduleDelegate} from \"./scheduleDelegate\";\nimport {Spline} from './spline';\n\nclass sprite {\n  constructor(){\n\n  }\n\n  init ( image ) {\n    this.local  = {\n      pos :{x:0,y:0},\n      rot : 0,\n    }\n    this.img = image;\n  }\n\n  getCtx () {\n    return this.canvas.getContext(\"2d\");\n  }\n\n  setCanvas ( canvas ) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext(\"2d\");\n    return this;\n  }\n\n  transform ( pos , rot ) {\n    this.move(pos).rotate(rot).emit();\n  }\n\n  move ( pos ) {\n    this.local.pos = pos;\n    return this;\n  }\n\n  rotate (  rot  ) {\n    this.local.rot = rot;\n    return this;\n  }\n\n  emit () {\n    const ctx = this.getCtx();\n    ctx.save();\n    const _rot = this.local.rot;\n    const _pos = this.local.pos;\n    \n    // 回転の中心位置を計算（画像の中心を回転中心にする）\n    const cx = _pos.x + this.img.width/2;\n    const cy = _pos.y + this.img.height/2;\n\n    // 画像を回転\n    ctx.setTransform(\n      Math.cos(_rot), \n      Math.sin(_rot), \n      -Math.sin(_rot), \n      Math.cos(_rot),\n      cx-cx*Math.cos(_rot)+cy*Math.sin(_rot),\n      cy-cx*Math.sin(_rot)-cy*Math.cos(_rot)\n    );\n    ctx.drawImage(this.img, _pos.x, _pos.y);\n    ctx.restore();\n    return this;\n  }\n}\n\nconst base_fps = 60;\n\nclass animOptimize {\n  /***\n   * 基準 fps = 60\n   * 1.再生時間から全フレーム数を算出\n   * 2.1フレームあたりの移動量\n   * 3.\n   * \n   * { pos {x:0,y:0} time:0.0 }\n   * { pos {x:0,y:60} time:2.0 }\n   * \n   * 1. 60 * 2.0 = 120.0\n   * 2. fps/120.0 = 移動量\n   * \n   */\n\n  constructor(){\n    this.fps = 0;\n    this.fps_prev  = new Date().getTime();\n    this.update();\n  }\n  \n  update () {\n    window.requestAnimationFrame(this.update.bind(this));\n    this.flatFps();\n  }\n   /**\n   * fps平均化\n   */\n  flatFps  () {\n    const _fps_current = new Date().getTime();\n    const time = _fps_current - this.fps_prev;\n    this.fps_prev = _fps_current;\n    const FPS = (1000/time).toFixed(1);\n    //console.log(\"fps \" , FPS , time);\n  }\n}\n\nconst range = (min, max) => {\n  const len  = max - min;\n  const rand = Math.random() * len;\n  return min + rand;\n}\n\n\nexport class aniSprite extends sprite {\n\n  constructor( value, image , scheduler){\n\n    super(image);\n    this.value = value;\n    this.scheduler = scheduler;\n    this.isPlay = true;\n\n    this.frame  = 0;\n\n    this.schedule = new scheduleDelegate();\n    //this.ftpOptimizer = new animOptimize();\n\n    this.init( image );\n    this.makeFrames();\n    this.makeSplineFrames();\n    this.update();\n\n  }\n\n  getImageSrc () {\n    return this.sprite.value.src;\n  }\n\n  update () {\n    window.requestAnimationFrame(this.update.bind(this));\n    this.playAnims();\n  }\n\n  playAnims () {\n    if ( this.frame >= this.value.splineFrames.length )\n    { this.frame = 0; } else \n    { this.frame++; }\n  }\n\n  makeSplineFrames ( ) {\n\n    let  _anim =  this.value.anim;\n\n    const getValuePerFrame = ( current , next , frames , index )=>{\n      return current + ((( next - current ) /frames ) * index ) ;\n    }\n\n    let rots = [];\n    _anim.map(( val , index  ) => {\n      if( _anim[index+1] ) {\n        const _time = _anim[index+1].time - _anim[index].time;\n        const frames  = base_fps * _time;\n        const _frames = Array.apply(null,new Array(frames));\n        let list = _frames.map(( value  , n ) =>{\n          const r = getValuePerFrame(_anim[index].rot , _anim[index+1].rot,frames,n);\n          return { rot :Math.floor(r) };\n        })\n        rots = rots.concat(list);\n      }\n    })\n\n    if( _anim.length ==  1 ) {\n      rots[0] = { rot : _anim[0].rot };\n    }\n\n    //位置の曲線変換\n    let posx = [];\n    let posy = [];\n    _anim.map(( val ) =>{\n      posx.push(val.pos.x);\n      posy.push(val.pos.y);\n    })\n    const spx = new Spline();\n    const spy = new Spline();\n    spx.init(posx);\n    spy.init(posy);\n\n    this.value.splineFrames = [];\n    let total_frames = 0;\n    _anim.map(( val  ,index ) => {\n      if( _anim[index+1] ) {\n        const _time = _anim[index+1].time - _anim[index].time;\n        const frames  = base_fps * _time;\n        total_frames += frames;\n      }\n      index++;\n    })\n    \n    const total_frames_array = Array.apply( null , Array(total_frames));\n    let list = total_frames_array.map(( val , index  ) => {\n      const m = ((_anim.length-1)/total_frames);\n      const i = (m*index).toFixed(2);\n      const x = spx.culc( i );\n      const y = spy.culc( i );\n      return { index :index , pos :{x:x,y:y} };\n    });\n\n    if( this.value.tiltFlag ) list.reverse();//回転変換を使う場合はフレーム順を変える\n\n    this.value.splineFrames = list.map(( val  , index  ) =>{\n      return { index :val.index ,pos:val.pos  ,rot:rots[index].rot};\n    })\n    //console.log(\"this.value.splineFrames \" ,this.value.splineFrames);\n  }\n\n  /**\n   * フレーム数を確定\n   * とりあえずposだけ\n   */\n  makeFrames () {\n    const getValuePerFrame = ( current , next , frames , index )=>{\n      return (( next - current ) /frames ) * index ;\n    }\n\n    this.value.frames = [];\n    _.each( this.value.anim , ( val , index  ) => {\n      if( this.value.anim[index+1] ) {\n        const _time = this.value.anim[index+1].time - this.value.anim[index].time;\n        const frames  = base_fps * _time;\n        const _frames = new Array(frames);\n        let list = _.map( _frames , ( value , n ) =>{\n          const x = getValuePerFrame(this.value.anim[index].pos.x , this.value.anim[index+1].pos.x,frames,n);\n          const y = getValuePerFrame(this.value.anim[index].pos.y ,this.value.anim[index+1].pos.y,frames,n);\n          return { index :n , pos :{x:x,y:y} };\n        })\n        this.value.frames = this.value.frames.concat(list);\n      }else {\n        this.value.frames.push({index:1 , pos:this.value.anim[index].pos });\n      }\n    })\n  }\n\n  transform ( pos , tilt , deg ) {\n\n    let _pos = pos;\n    let _tilt = tilt;\n\n    _pos = this.localMove(pos , deg);\n    _tilt = this.localRotate(tilt );\n\n    //180° => ラジアン\n    if( !this.value.tiltFlag ) _tilt = 180*Math.PI/180;\n\n    this.move(_pos).rotate(_tilt).emit();\n  }\n\n  /**\n   * ローカル座標\n   * @param {*} pos \n   * @param {int} index\n   */\n  localMove ( pos , theta) {\n    \n    if( \n      !_.has(this.value,\"frames\") || \n      !this.value.splineFrames[this.frame]\n    ) return  pos;\n\n    const fpos = this.value.splineFrames[this.frame].pos;\n\n    //回転行列\n    const _pos_x =  (Math.cos(theta)* fpos.x) + (Math.sin(theta)* fpos.y );\n    const _pos_y =  (-1 * Math.sin(theta)* fpos.x) + (Math.cos(theta)* fpos.y );\n\n    if( !this.value.tiltFlag ) {\n      return {\n        x : pos.x + fpos.x,\n        y : pos.y + fpos.y\n      }\n    } else  {\n      return {\n        x : pos.x + _pos_x,\n        y : pos.y + _pos_y\n      }\n    }\n\n  }\n\n  /**\n   * ローカル座標\n   * @param {*} rot \n   * @param {int} index\n   */\n  localRotate ( rot ,  n  = 0) {\n    if( \n      !_.has(this.value,\"anim\") || \n      !this.value.splineFrames[this.frame]||\n      !_.has(this.value.splineFrames[this.frame],\"rot\")\n    ) return  rot;\n\n    if(!this.value.tiltFlag) return  rot;\n    \n    return rot + this.value.splineFrames[n].rot;\n  }\n}\n\nclass ani {\n\n  constructor(){\n  \n  }\n}\n\nconst instance =  new ani();\nexport default instance;","import React, { Component } from \"react\";\nimport * as _ from 'lodash';\nimport { sigmoid } from \"face-api.js\";\nimport {aniSprite} from './ani';\n\nexport default class AssetLoader extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      done:false,\n      progress : 0,\n      images : [],\n      anies : [],\n    }\n    _.map( props.assets , asset =>{\n      this.loadImage(asset);\n    })\n  }\n\n  loadImage( asset ){\n    _.each ( asset.src , path => {\n      let img = new Image();\n      img.onload = ( image ) =>{\n        let images = this.state.images;\n        images.push({\n          id:asset.id,\n          image:img,\n        });\n        this.setState({\n          progress : this.state.progress+1,\n          images:images,\n        });\n        \n        this.props.progress({\n          result : this.state.progress ,\n          total : this.props.assets.length\n        });\n\n        if( this.props.assets.length === this.state.progress ) {\n\n          let anies = _.map( this.state.images , image =>{\n            const value = _.filter( this.props.assets , asset =>{return asset.id===image.id });\n            return {\n              id:image.id,\n              sprite:new aniSprite( value[0] , image.image , this.schedule )\n            };\n          });\n\n          this.setState({\n            done:true,\n            anies:anies,\n          });\n\n          this.props.done();\n        }\n      }\n      img.src = path;\n    })\n  }\n\n  show () {\n    if ( this.state.done ) {\n      return this.props.view(this.state.anies)\n    }\n    return null\n  }\n\n  render(){\n    return(<React.Fragment>{this.show()}</React.Fragment>)\n  }\n}","import React, { Component } from \"react\";\nimport * as _ from \"lodash\";\nimport AssetLoader from \"../AssetLoader\";\nimport { aniSprite } from \"../ani\";\nimport styles from \"./AssetsSelectMenu.scss\";\n\nexport default class AssetsSelectMenu extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  GetMenu(anies) {\n    return _.map(anies, ani => {\n      return (\n        <AssetButton\n          id={ani.id}\n          src={ani.sprite.value.src[0]}\n          callback={id => {\n            this.props.callback(id);\n          }}\n        />\n      );\n    });\n  }\n\n  render() {\n    const classname = () => {\n      return this.props.show ? styles[\"List\"] + \" show\" : styles[\"List\"];\n    };\n    return (\n      <AssetLoader\n        assets={this.props.assets}\n        progress={progress => {}}\n        done={() => {}}\n        view={anies => {\n          return <div className={classname()}>{this.GetMenu(anies)}</div>;\n        }}\n      />\n    );\n  }\n}\n\nconst AssetButton = ({ id, src, callback }) => {\n  return (\n    <div\n      className={styles[\"ListItem\"]}\n      onClick={e => {\n        callback(id);\n      }}\n    >\n      <img src={src} />\n    </div>\n  );\n};\n","import save from \"./baseline_save_white_48dp.png\";\nimport stamps from \"./baseline_favorite_white_48dp.png\";\nimport assets from \"./baseline_toys_white_48dp.png\";\nimport del from \"./baseline_delete_white_48dp.png\";\nimport play from \"./baseline_play_circle_outline_white_48dp.png\";\n\nexport const icons = {\n  save,\n  stamps,\n  assets,\n  del,\n  play\n};\n","import React, { Component } from \"react\";\nimport * as _ from \"lodash\";\nimport { aniSprite } from \"../ani\";\nimport { load } from \"@tensorflow-models/posenet\";\nimport styles from \"./StampManager.scss\";\nimport { icons } from \"../../icon/Icons\";\n\n/***\n * アセットと座標を保存する\n */\n\nexport default class StampManager extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      data: []\n    };\n    this.assets = props.assets; //元のデータ\n    this.callback = {\n      save: this.saveAsset.bind(this),\n      load: this.loadAsset.bind(this),\n      delete: this.deleteAsset.bind(this)\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (\n      JSON.stringify(nextProps.assets) !== JSON.stringify(this.props.assets)\n    ) {\n      this.assets = nextProps.assets;\n    }\n  }\n\n  saveAsset() {\n    let _asset = _.filter(this.assets, val => {\n      return val.id == this.props.currentAsset.assetId;\n    });\n    let newData = _.clone(this.props.currentAsset);\n    newData.id = parseInt(_.uniqueId());\n    newData.src = _asset[0].src[0];\n\n    let data = _.clone(this.state.data);\n    data.push(newData);\n    this.setState({ data });\n\n    //TODO クラウドに保存\n  }\n\n  loadAsset(id) {\n    let filtered = _.filter(this.state.data, val => {\n      return val.id === id;\n    });\n    let data = _.clone(filtered[0]);\n    delete data.src;\n    delete data.id;\n    this.props.callback(data);\n  }\n\n  deleteAsset(id) {\n    let filtered = _.filter(this.state.data, val => {\n      return val.id !== id;\n    });\n    this.setState({\n      data: filtered\n    });\n  }\n\n  getAssets() {\n    return _.map(this.state.data, (asset, index) => {\n      return (\n        <AssetButton\n          key={asset.id}\n          id={asset.id}\n          src={asset.src}\n          callback={this.callback}\n        />\n      );\n    });\n  }\n\n  render() {\n    const classname = () => {\n      return this.props.show ? styles[\"List\"] + \" show\" : styles[\"List\"];\n    };\n    return (\n      <div className={classname()}>\n        <div className={styles[\"Save\"]}>\n          <button\n            onClick={e => {\n              this.saveAsset();\n            }}\n          >\n            <img src={icons.save} />\n            <p className=\"label\">保存</p>\n          </button>\n        </div>\n        {this.getAssets()}\n      </div>\n    );\n  }\n}\n\nconst AssetButton = ({ id, src, callback }) => {\n  return (\n    <div className={styles[\"ListItem\"]}>\n      <img src={src} />\n      <div className=\"navi\">\n        <button\n          onClick={() => {\n            callback.load(id);\n          }}\n        >\n          <img src={icons.play} />\n          <div className=\"label\">load</div>\n        </button>\n        <button\n          onClick={() => {\n            callback.delete(id);\n          }}\n        >\n          <img src={icons.del} />\n          <div className=\"label\">delete</div>\n        </button>\n      </div>\n    </div>\n  );\n};\n","import React, { Component } from \"react\";\nimport * as _ from \"lodash\";\nimport styles from \"./Header.scss\";\nimport { icons } from \"../../icon/Icons\";\n\nexport const Header = props => {\n  return (\n    <div className={styles[\"Header\"]}>\n      <ul>\n        {_.map(props.menu, val => {\n          return (\n            <HeaderItem\n              id={val.id}\n              icon={icons[val.icon]}\n              label={val.label}\n              callback={val.callback}\n              show={val.show}\n            />\n          );\n        })}\n      </ul>\n    </div>\n  );\n};\n\nexport const HeaderItem = props => {\n  const classname = () => {\n    return props.show ? styles[\"HeaderItem\"] + \" show\" : styles[\"HeaderItem\"];\n  };\n  return (\n    <li\n      className={classname()}\n      onClick={e => {\n        props.callback(e, props.id);\n      }}\n    >\n      {props.children}\n      <img className=\"icon\" src={props.icon} alt={props.label} />\n      <p className=\"label\">{props.label}</p>\n    </li>\n  );\n};\n","import React, { Component } from \"react\";\nimport * as faceapi from \"face-api.js/dist/face-api.js\";\nimport * as _ from \"lodash\";\nimport { FaceDetect } from \"./components/FaceDetect\";\nimport { FaceDetectView } from \"./components/FaceDetectView\";\nimport { VideoImage } from \"./components/VideoCanvas\";\nimport { getLandmarks } from \"./canvas.point\";\nimport { VIDEO_SIZE, INTERVAL, PARTS_INDEX } from \"./config\";\nimport AssetLoader from \"./components/AssetLoader\";\nimport AssetsSelectMenu from \"./components/AssetsSelectMenu/AssetsSelectMenu\";\nimport StampManager from \"./components/StampManager/StampManager\";\nimport { aniSprite } from \"./components/ani\";\nimport { scheduleDelegate } from \"./components/scheduleDelegate\";\nimport styles from \"./App.scss\";\nimport { Header, HeaderItem } from \"./components/Header/Header\";\nimport { icons } from \"./icon/Icons\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    //使用するアセット\n    this.assets = [\n      {\n        id: 1,\n        type: \"image\",\n        src: [\"./images/star_01.png\"],\n        tiltFlag: true,\n        anim: [\n          {\n            index: 1,\n            pos: { x: 0, y: 0 },\n            rot: 0,\n            scale: { x: 1, y: 1 },\n            time: 0.0\n          },\n          {\n            index: 2,\n            pos: { x: -100, y: 100 },\n            rot: 360,\n            scale: { x: 1, y: 1 },\n            time: 0.5\n          },\n          {\n            index: 3,\n            pos: { x: -100, y: 200 },\n            rot: 180,\n            scale: { x: 1, y: 1 },\n            time: 1.0\n          },\n          {\n            index: 4,\n            pos: { x: 100, y: 0 },\n            rot: 200,\n            scale: { x: 1, y: 1 },\n            time: 1.5\n          },\n          {\n            index: 5,\n            pos: { x: -100, y: -200 },\n            rot: 360,\n            scale: { x: 1, y: 1 },\n            time: 2.0\n          },\n          {\n            index: 6,\n            pos: { x: 0, y: 100 },\n            rot: 180,\n            scale: { x: 1, y: 1 },\n            time: 2.5\n          },\n          {\n            index: 7,\n            pos: { x: 0, y: 0 },\n            rot: 0,\n            scale: { x: 1, y: 1 },\n            time: 3.0\n          }\n        ]\n      },\n      {\n        id: 2,\n        type: \"ani\",\n        src: [\"./images/arrow_left.png\"],\n        tiltFlag: true,\n        anim: [\n          {\n            index: 1,\n            pos: { x: 0, y: 0 },\n            rot: 0,\n            scale: { x: 1, y: 1 },\n            time: 0.0\n          },\n          {\n            index: 2,\n            pos: { x: 10, y: 0 },\n            rot: 45,\n            scale: { x: 1, y: 1 },\n            time: 0.5\n          },\n          {\n            index: 3,\n            pos: { x: 80, y: 0 },\n            rot: 90,\n            scale: { x: 1, y: 1 },\n            time: 1.0\n          },\n          {\n            index: 4,\n            pos: { x: 90, y: 0 },\n            rot: 95,\n            scale: { x: 1, y: 1 },\n            time: 1.5\n          }\n        ]\n      },\n      {\n        id: 3,\n        type: \"ani\",\n        src: [\"./images/arrow_left.png\"],\n        tiltFlag: false,\n        anim: [\n          {\n            index: 1,\n            pos: { x: 0, y: 0 },\n            rot: 0,\n            scale: { x: 1, y: 1 },\n            time: 0.0\n          }\n        ]\n      }\n    ];\n\n    //アセットの表示スケジュール(未実装)\n    //TODO:中心位置を設定する\n    // this.schedules = [\n    //   {\n    //     start:1.0,\n    //     end:2.0,\n    //     asset:1,\n    //     position:{\n    //       x:null,\n    //       y:null\n    //     }\n    //   },\n    //   {\n    //     start:3.0,\n    //     end:4.0,\n    //     asset:2,\n    //     position:{\n    //       x:null,\n    //       y:null\n    //     }\n    //   },\n    //   {\n    //     start:5.0,\n    //     end:6.0,\n    //     asset:3,\n    //     position:{\n    //       x:null,\n    //       y:null\n    //     }\n    //   },\n    // ];\n\n    this.state = {\n      video: null,\n      canvas: null,\n      overlay: null,\n      result: null,\n      landmarks: null,\n      positions: null,\n      anies: [],\n      editMode: true, //アセットの表示非表示\n      stampMode: true, //スタンプの表示非表示\n      data: {\n        //ロードするスタンプ\n        assetId: 1,\n        rate: {},\n        bool: {}\n      }\n    };\n\n    this.partsConfig = {\n      base: PARTS_INDEX.leftEye,\n      vector: PARTS_INDEX.rightEye\n    };\n\n    this.callback = {\n      edit: () => {},\n      assets: () => {\n        this.setState({ editMode: !this.state.editMode });\n      },\n      stamps: () => {\n        this.setState({ stampMode: !this.state.stampMode });\n      }\n    };\n\n    this.overlay = null;\n\n    //イベントを設定\n    // this.schedule = new scheduleDelegate();\n    // _.each( this.schedules , val =>{\n    //   this.schedule.setCallback({\n    //     time:val.start,\n    //     callback:()=>{\n    //       console.log(\"start\",val.asset ,val.start);\n    //     }\n    //   })\n    //   this.schedule.setCallback({\n    //     time:val.end,\n    //     callback:()=>{\n    //       console.log(\"end\",val.asset ,val.end);\n    //     }\n    //   })\n    // })\n    // this.schedule.start();\n  }\n\n  setCanvas(ref) {\n    if (this.state.canvas !== ref && ref) {\n      this.setState({ canvas: ref });\n    }\n  }\n\n  setVideo(ref) {\n    if (this.state.video !== ref && ref) {\n      this.setState({ video: ref });\n    }\n  }\n\n  setOverlay(ref) {\n    if (this.state.overlay !== ref && ref) {\n      this.setState({ overlay: ref });\n      this.initCanvas();\n    }\n  }\n\n  initCanvas() {\n    if (!this.state.canvas || !this.state.overlay) return;\n    this.setState({\n      width: VIDEO_SIZE.width,\n      height: VIDEO_SIZE.height\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Header\n          menu={[\n            {\n              id: 1,\n              label: \"assets\",\n              icon: \"assets\",\n              callback: this.callback.assets,\n              show: this.state.editMode\n            },\n            {\n              id: 2,\n              label: \"stamps\",\n              icon: \"stamps\",\n              callback: this.callback.stamps,\n              show: this.state.stampMode\n            }\n          ]}\n        />\n        <div className={styles[\"viewer\"]}>\n          <VideoImage\n            size={VIDEO_SIZE}\n            interval={INTERVAL}\n            video={ref => {\n              this.setVideo(ref);\n            }}\n            canvas={ref => {\n              this.setCanvas(ref);\n            }}\n          />\n          <FaceDetect\n            canvas={this.state.canvas}\n            video={this.state.video}\n            interval={INTERVAL}\n            result={result => {\n              const { width, height } = faceapi.getMediaDimensions(\n                this.state.video\n              );\n              const resizedResults = [result].map(res =>\n                res.forSize(width, height)\n              );\n              const landmarks = getLandmarks(resizedResults[0].faceLandmarks);\n              this.setState({\n                landmarks: landmarks,\n                positions: resizedResults[0].landmarks.positions\n              });\n            }}\n          />\n          <AssetLoader\n            assets={this.assets}\n            progress={progress => {}}\n            done={() => {}}\n            view={anies => {\n              return (\n                <React.Fragment>\n                  <FaceDetectView\n                    showEyes={false} //眼の点を表示 ediMode=trueの場合はtrue\n                    showPoints={false} //クリック点を表示\n                    editMode={this.state.editMode} //編集モード\n                    multiPoints={false} //複数ポイント作成\n                    editCallback={points => {\n                      console.log(\"edit  callback \", points);\n                      //アセットを更新\n                      let data = this.state.data;\n                      data.bool = points.bool;\n                      data.rate = points.rate;\n                      data.assetId = points.assetId;\n                      this.setState({ data });\n                    }} //クリック点の座標データ\n                    video={this.state.video} //videoタグ\n                    setRef={ref => {\n                      this.setOverlay(ref);\n                    }} //canvasタグ\n                    partsConfig={this.partsConfig} //基準パーツ\n                    landmarks={this.state.landmarks} //検出パーツ\n                    positions={this.state.positions} //描画用の点\n                    anies={anies} //AssetLoaderから返されるアニメーションデータ\n                    loadData={this.state.data}\n                  />\n                </React.Fragment>\n              );\n            }}\n          />\n        </div>\n\n        <AssetsSelectMenu\n          show={this.state.editMode}\n          assets={this.assets}\n          callback={id => {\n            let data = _.clone(this.state.data);\n            data.assetId = id;\n            this.setState({ data });\n          }}\n        />\n\n        <StampManager\n          show={this.state.stampMode}\n          assets={this.assets}\n          currentAsset={this.state.data}\n          callback={data => {\n            this.setState({ data });\n          }}\n        />\n      </div>\n    );\n  }\n}\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"List\":\"uThst4IvgrclNdKKirhKm\",\"ListItem\":\"_1eUPmp4sFlGnA9iR6Z2yA0\",\"Save\":\"_32Sa-LcM3vqu_cVGP-8nv5\"};"],"sourceRoot":""}