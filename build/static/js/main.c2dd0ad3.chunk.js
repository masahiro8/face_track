(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(t,e,a){t.exports={overlayClickable:"P2Ozy3EA7iOKnUsuEd04Y",overlayCanvas:"_1VTjcrIdjUewwZ-qVkXQxP",videoimage:"_27P8rrrUDhjUTuQVCNHvHs"}},257:function(t,e,a){t.exports=a(781)},262:function(t,e,a){},267:function(t,e){},269:function(t,e){},301:function(t,e){},302:function(t,e){},781:function(t,e,a){"use strict";a.r(e);var s=a(6),n=a.n(s),i=a(255),r=a.n(i),o=(a(262),a(17)),c=a(19),l=a(27),u=a(25),h=a(26),d=a(41),p=a(11),v=a(44),f=a.n(v),m=a(73),y=(a(350),function(t,e,a){var s=t.getContext("2d");s.fillStyle=a||"#0ff",s.fillRect(e.x,e.y,4,4)}),g=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).canvas=null,a.pointlog=null,a.net=new d.FaceLandmark68TinyNet,a.state={faceDetect:{}},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=Object(m.a)(f.a.mark(function t(){var e=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.nets.tinyFaceDetector.load("models/face/");case 2:return t.next=4,d.loadFaceLandmarkModel("models/face/");case 4:console.log("load models"),setInterval(Object(m.a)(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.predict();case 2:case"end":return t.stop()}},t,this)})),this.props.interval);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"predict",value:function(){var t=Object(m.a)(f.a.mark(function t(){var e,a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.props.canvas){t.next=2;break}return t.abrupt("return");case 2:return 128,.5,e=new d.TinyFaceDetectorOptions({inputSize:128,scoreThreshold:.5}),t.next=7,d.detectSingleFace(this.props.video,e).withFaceLandmarks();case 7:(a=t.sent)&&(this.setState({faceDetect:a}),this.props.result(a));case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement("div",null)}}]),e}(s.Component),b=a(256),k=a.n(b),x={width:640,height:480},w=Math.floor(1e3/30),O={nose:30,leftEye:38,rightEye:44},E=function(t,e){return{x:(e.x-t.x).toFixed(2),y:(e.y-t.y).toFixed(2)}},j=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},C=function(t,e){return t.x*e.x+t.y*e.y},S=function(t,e){return t.x*e.y-e.x*t.y},M=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},A=a(123),P=a.n(A),R=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).canvas=null,a.tilt=null,a.deg=null,a.radian=null,a.star=null,a.BASE_PARTS=a.props.partsConfig.base,a.VECTOR_PARTS=a.props.partsConfig.vector,a.positions=Array.apply(null,new Array(68)),a.positions[a.VECTOR_PARTS]={x:0,y:0},a.positions[a.BASE_PARTS]={x:0,y:0},a.state={assetId:null,points:[],tilt:null},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentWillReceiveProps",value:function(t){var e=this;if(JSON.stringify(t.loadData)!==JSON.stringify(this.props.loadData)){console.log("points",this.state.points);var a=this.state.points;a[0]=t.loadData,this.setState({points:a,assetId:t.loadData.assetId})}t.landmarks&&(this.clearCanvas(),this.props.positions?(this.positions[this.VECTOR_PARTS]=this.lowpathFilter(this.props.positions[this.VECTOR_PARTS],t.positions[this.VECTOR_PARTS]),this.positions[this.BASE_PARTS]=this.lowpathFilter(this.props.positions[this.BASE_PARTS],t.positions[this.BASE_PARTS])):(this.positions[this.VECTOR_PARTS]=t.positions[this.VECTOR_PARTS],this.positions[this.BASE_PARTS]=t.positions[this.BASE_PARTS]),this.detectTilt(this.positions[this.VECTOR_PARTS],this.positions[this.BASE_PARTS]),(this.props.showEyes||this.props.editMode)&&this.drawPoints(),this.props.showPoints&&this.drawParts(),this.state.points.length&&p.each(this.state.points,function(t,a){e.initPointRate(t,a,e.positions[e.BASE_PARTS],e.positions[e.VECTOR_PARTS]),e.setPoint(t,a,e.positions[e.BASE_PARTS],e.positions[e.VECTOR_PARTS])}))}},{key:"setCanvas",value:function(t){this.canvas=t,this.props.setRef(t)}},{key:"lowpathFilter",value:function(t,e){return{x:.9*t.x+.1*e.x,y:.9*t.y+.1*e.y}}},{key:"detectTilt",value:function(t,e){var a,s=E(t,e),n=S(s,{x:100,y:0});this.radian=Math.acos((a=s).x/j(a)),this.deg=this.radian*(180/Math.PI),this.tilt=n<0?this.radian:-this.deg*(Math.PI/180)}},{key:"setPoint",value:function(t,e,a,s){var n=this,i={x:0,y:0},r=E(a,s),o=j(r),c=M(i,r),l=c*t.rate.dot,u=i.x+r.x/o*l+a.x,h=i.y+r.y/o*l+a.y,d=c*t.rate.cross,v=(t.bool.cross?270:90)*Math.PI/180,f={x:d*Math.cos(v)+u,y:d*Math.sin(v)+h},m=p.filter(this.props.anies,function(t){return t.id==n.state.assetId});if(m.length){var g=m[0].sprite.img,b=f.x-g.width/2,k=f.y-g.height/2;m[0].sprite.setCanvas(this.canvas).transform({x:b,y:k},this.tilt,-this.tilt)}this.props.editMode&&y(this.canvas,{x:f.x,y:f.y},"rgba(255,255,255)")}},{key:"initPointRate",value:function(t,e,a,s){if(!t.rate){var n={x:0,y:0},i=E(a,s),r=E(a,t.vector),o=S(i,r),c=Math.abs(o/M(n,i)),l=C(i,r),u=function(t,e){var a=j(t),s=j(e);return Math.cos(C(t,e)/(a*s))}(i,r),h=k.a.acos(u)*j(r),d=M(n,i),v=h/d,f=c/d,m=this.state.points[e];m.bool={dot:!(l<0),cross:o<0},m.rate={dot:l<0?-v:v,cross:f};var y=this.state.points;y[e]=p.clone(m),this.setState({points:y}),this.props.editMode&&(m.assetId=this.state.assetId,this.props.editCallback(m))}}},{key:"clearCanvas",value:function(){this.canvas.getContext("2d").clearRect(0,0,x.width,x.height)}},{key:"drawPoints",value:function(){var t=this,e=0;p.each(this.props.positions,function(a){e==t.BASE_PARTS&&y(t.canvas,{x:a.x,y:a.y},"rgba(255,0,0)"),e==t.VECTOR_PARTS&&y(t.canvas,{x:a.x,y:a.y},"rgba(0,255,0)"),e++})}},{key:"drawParts",value:function(){var t=this,e=this.props.landmarks,a=0,s=0,n=Math.floor(25.5);p.each(e,function(e,i){a++,s=0,e.map(function(e){s++,y(t.canvas,{x:e.x,y:e.y},function(t,e){return["rgb(255,".concat(e,",").concat(e,")"),"rgb(".concat(e,",255,").concat(e,")"),"rgb(".concat(e,",").concat(e,",255)"),"rgb(255,255,".concat(e,")"),"rgb(".concat(e,",255,255)"),"rgb(255,".concat(e,",255)"),"rgb(".concat(e,",").concat(e,",").concat(e,")")][t]}(a,s*n))})})}},{key:"addPoint",value:function(t){var e=this.canvas.getBoundingClientRect(),a=t.clientX-e.left,s=t.clientY-e.top,n=this.state.points;n[0]={vector:{x:a,y:s},rate:null},this.setState({points:n}),console.log("setpoint",n)}},{key:"addMultiPoints",value:function(t){var e=this.canvas.getBoundingClientRect(),a=t.clientX-e.left,s=t.clientY-e.top,n=this.state.points;n.push({vector:{x:a,y:s},rate:null}),this.setState({points:n})}},{key:"render",value:function(){var t=this;return n.a.createElement("canvas",{ref:function(e){t.setCanvas(e)},width:x.width,height:x.height,className:P.a.overlayCanvas,onClick:function(e){t.props.multiPoints?t.addMultiPoints(e):t.addPoint(e)}})}}]),e}(s.Component),T=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).media=null,a.selfRef=null,a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=Object(m.a)(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initCam();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"initCam",value:function(){var t=Object(m.a)(f.a.mark(function t(){var e,a=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.media=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:this.props.size.width}}),e=new Promise(function(t){a.media.then(function(e){a.selfRef.srcObject=e,a.selfRef.onloadedmetadata=function(e){t()}}),a.media.catch(function(t){alert(t)})}),t.abrupt("return",e);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return n.a.createElement("video",{ref:function(e){t.selfRef=e,t.props.setSelf(e)},className:"video",autoPlay:!0,playsInline:!0,width:x.width,height:x.height})}}]),e}(s.Component),_=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).canvas=null,a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;setInterval(function(){t.draw()},this.props.interval)}},{key:"draw",value:function(){if(this.props.video&&this.props.canvas){this.props.video.getBoundingClientRect();var t=this.canvas.getContext("2d");this.canvas.width=this.props.size.width,this.canvas.height=this.props.size.height,t.drawImage(this.props.video,0,0,this.props.size.width,this.props.size.height)}}},{key:"render",value:function(){var t=this;return n.a.createElement("canvas",{ref:function(e){t.canvas=e,t.props.set(e)},id:"canvas",className:"canvas"})}}]),e}(s.Component),F=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={video:null,canvas:null},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"setVideo",value:function(t){this.state.video!==t&&t&&(this.setState({video:t}),this.props.video(t))}},{key:"setCanvas",value:function(t){this.state.canvas!==t&&t&&(this.setState({canvas:t}),this.props.canvas(t))}},{key:"render",value:function(){var t=this;return n.a.createElement("div",{className:P.a.videoimage},n.a.createElement(T,{size:this.props.size,setSelf:function(e){t.setVideo(e)}}),n.a.createElement(_,{size:this.props.size,video:this.state.video,set:function(e){t.setCanvas(e)},interval:this.props.interval}))}}]),e}(s.Component),I=(a(780),function(){function t(){Object(o.a)(this,t),this.isPlay=!1,this.time_total=null,this.time_start=null,this.time_interval=null,this.time_current=null,this.time_prev=null,this.delegate=[],this.init()}return Object(c.a)(t,[{key:"init",value:function(){}},{key:"update",value:function(){this.isPlay&&(this.setCurrent(),this.checkCallback(this.time_total)),window.requestAnimationFrame(this.update.bind(this))}},{key:"checkCallback",value:function(t){if(this.delegate.length){var e=p.filter(this.delegate,function(e){return e.time==Math.floor(t/1e3)});this.delegate=p.reject(this.delegate,function(e){return e.time==Math.floor(t/1e3)}),p.each(e,function(t){t.callback()})}}},{key:"start",value:function(){this.time_total=0,this.restart(),this.update()}},{key:"restart",value:function(){this.time_start=(new Date).getTime(),this.time_current=(new Date).getTime(),this.time_prev=(new Date).getTime(),this.time_interval=0,this.isPlay=!0}},{key:"pause",value:function(){this.isPlay=!1}},{key:"setCurrent",value:function(){var t=(new Date).getTime();this.time_current=t-this.time_start,this.time_interval=t-this.time_prev,this.time_total+=this.time_interval,this.time_prev=t}},{key:"setCallback",value:function(t){this.delegate.push({time:t.time,callback:t.callback})}}]),t}()),B=(Math.cos,Math.sin,Math.abs,Math.PI,Math.floor);Math.random;function D(){this.a=[],this.b=[],this.c=[],this.d=[],this.num=0}D.prototype={constructor:D,num:0,a:null,b:null,c:null,d:null,init:function(t){var e,a,s=[];this.num=t.length-1;var n=this.num,i=this.a,r=this.b,o=this.c,c=this.d;for(a=0;a<=n;a++)i[a]=t[a];for(o[0]=o[n]=0,a=1;a<n;a++)o[a]=3*(i[a-1]-2*i[a]+i[a+1]);for(s[0]=0,a=1;a<n;a++)e=4-s[a-1],o[a]=(o[a]-o[a-1])/e,s[a]=1/e;for(a=n-1;a>0;a--)o[a]=o[a]-o[a+1]*s[a];for(r[n]=c[n]=0,a=0;a<n;a++)c[a]=(o[a+1]-o[a])/3,r[a]=i[a+1]-i[a]-o[a]-c[a]},culc:function(t){var e,a=B(t),s=this.num,n=this.a,i=this.b,r=this.c,o=this.d;return a<0?a=0:a>=s&&(a=s-1),e=t-a,n[a]+(i[a]+(r[a]+o[a]*e)*e)*e}};var V=function(){function t(){Object(o.a)(this,t)}return Object(c.a)(t,[{key:"init",value:function(t){this.local={pos:{x:0,y:0},rot:0},this.img=t}},{key:"getCtx",value:function(){return this.canvas.getContext("2d")}},{key:"setCanvas",value:function(t){return this.canvas=t,this.ctx=t.getContext("2d"),this}},{key:"transform",value:function(t,e){this.move(t).rotate(e).emit()}},{key:"move",value:function(t){return this.local.pos=t,this}},{key:"rotate",value:function(t){return this.local.rot=t,this}},{key:"emit",value:function(){var t=this.getCtx();t.save();var e=this.local.rot,a=this.local.pos,s=a.x+this.img.width/2,n=a.y+this.img.height/2;return t.setTransform(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),s-s*Math.cos(e)+n*Math.sin(e),n-s*Math.sin(e)-n*Math.cos(e)),t.drawImage(this.img,a.x,a.y),t.restore(),this}}]),t}(),z=function(t){function e(t,a,s){var n;return Object(o.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,a))).value=t,n.scheduler=s,n.isPlay=!0,n.frame=0,n.schedule=new I,n.init(a),n.makeFrames(),n.makeSplineFrames(),n.update(),n}return Object(h.a)(e,t),Object(c.a)(e,[{key:"getImageSrc",value:function(){return this.sprite.value.src}},{key:"update",value:function(){window.requestAnimationFrame(this.update.bind(this)),this.playAnims()}},{key:"playAnims",value:function(){this.frame>=this.value.splineFrames.length?this.frame=0:this.frame++}},{key:"makeSplineFrames",value:function(){var t=this.value.anim,e=[];t.map(function(a,s){if(t[s+1]){var n=60*(t[s+1].time-t[s].time),i=Array.apply(null,new Array(n)).map(function(e,a){var i=function(t,e,a,s){return t+(e-t)/a*s}(t[s].rot,t[s+1].rot,n,a);return{rot:Math.floor(i)}});e=e.concat(i)}}),1==t.length&&(e[0]={rot:t[0].rot});var a=[],s=[];t.map(function(t){a.push(t.pos.x),s.push(t.pos.y)});var n=new D,i=new D;n.init(a),i.init(s),this.value.splineFrames=[];var r=0;t.map(function(e,a){if(t[a+1]){var s=t[a+1].time-t[a].time;r+=60*s}a++});var o=Array.apply(null,Array(r)).map(function(e,a){var s=((t.length-1)/r*a).toFixed(2);return{index:a,pos:{x:n.culc(s),y:i.culc(s)}}});this.value.tiltFlag&&o.reverse(),this.value.splineFrames=o.map(function(t,a){return{index:t.index,pos:t.pos,rot:e[a].rot}})}},{key:"makeFrames",value:function(){var t=this,e=function(t,e,a,s){return(e-t)/a*s};this.value.frames=[],p.each(this.value.anim,function(a,s){if(t.value.anim[s+1]){var n=60*(t.value.anim[s+1].time-t.value.anim[s].time),i=new Array(n),r=p.map(i,function(a,i){return{index:i,pos:{x:e(t.value.anim[s].pos.x,t.value.anim[s+1].pos.x,n,i),y:e(t.value.anim[s].pos.y,t.value.anim[s+1].pos.y,n,i)}}});t.value.frames=t.value.frames.concat(r)}else t.value.frames.push({index:1,pos:t.value.anim[s].pos})})}},{key:"transform",value:function(t,e,a){var s,n=e;s=this.localMove(t,a),n=this.localRotate(e),this.value.tiltFlag||(n=180*Math.PI/180),this.move(s).rotate(n).emit()}},{key:"localMove",value:function(t,e){if(!p.has(this.value,"frames")||!this.value.splineFrames[this.frame])return t;var a=this.value.splineFrames[this.frame].pos,s=Math.cos(e)*a.x+Math.sin(e)*a.y,n=-1*Math.sin(e)*a.x+Math.cos(e)*a.y;return this.value.tiltFlag?{x:t.x+s,y:t.y+n}:{x:t.x+a.x,y:t.y+a.y}}},{key:"localRotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return p.has(this.value,"anim")&&this.value.splineFrames[this.frame]&&p.has(this.value.splineFrames[this.frame],"rot")&&this.value.tiltFlag?t+this.value.splineFrames[e].rot:t}}]),e}(V),N=(new function t(){Object(o.a)(this,t)},function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={done:!1,progress:0,images:[],anies:[]},p.map(t.assets,function(t){a.loadImage(t)}),a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"loadImage",value:function(t){var e=this;p.each(t.src,function(a){var s=new Image;s.onload=function(a){var n=e.state.images;if(n.push({id:t.id,image:s}),e.setState({progress:e.state.progress+1,images:n}),e.props.progress({result:e.state.progress,total:e.props.assets.length}),e.props.assets.length===e.state.progress){var i=p.map(e.state.images,function(t){var a=p.filter(e.props.assets,function(e){return e.id===t.id});return{id:t.id,sprite:new z(a[0],t.image,e.schedule)}});e.setState({done:!0,anies:i}),e.props.done()}},s.src=a})}},{key:"show",value:function(){return this.state.done?n.a.createElement("div",null,this.props.view(this.state.anies)):null}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,this.show())}}]),e}(s.Component)),J=function(t){function e(t){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).call(this,t))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"GetMenu",value:function(t){var e=this;return p.map(t,function(t){return n.a.createElement(L,{id:t.id,src:t.sprite.value.src[0],callback:function(t){e.props.callback(t)}})})}},{key:"render",value:function(){var t=this;return n.a.createElement(N,{assets:this.props.assets,progress:function(t){},done:function(){},view:function(e){return n.a.createElement("div",{style:t.props.editMode?{display:"block"}:{display:"none"}},t.GetMenu(e))}})}}]),e}(s.Component),L=function(t){var e=t.id,a=t.src,s=t.callback;return n.a.createElement("div",{style:{width:"48px"},onClick:function(t){s(e)}},n.a.createElement("img",{style:{width:"inherit"},src:a}))},q=a(53),U=(a(782),function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={data:[]},a.assets=t.assets,a.callback={save:a.saveAsset.bind(Object(q.a)(Object(q.a)(a))),load:a.loadAsset.bind(Object(q.a)(Object(q.a)(a))),delete:a.deleteAsset.bind(Object(q.a)(Object(q.a)(a)))},a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"componentWillReceiveProps",value:function(t){JSON.stringify(t.assets)!==JSON.stringify(this.props.assets)&&(this.assets=t.assets)}},{key:"saveAsset",value:function(){var t=this,e=p.filter(this.assets,function(e){return e.id==t.props.currentAsset.assetId}),a=p.clone(this.props.currentAsset);a.id=parseInt(p.uniqueId()),a.src=e[0].src[0];var s=p.clone(this.state.data);s.push(a),this.setState({data:s})}},{key:"loadAsset",value:function(t){var e=p.filter(this.state.data,function(e){return e.id===t}),a=p.clone(e[0]);delete a.src,delete a.id,this.props.callback(a)}},{key:"deleteAsset",value:function(t){var e=p.filter(this.state.data,function(e){return e.id!==t});this.setState({data:e})}},{key:"getAssets",value:function(){var t=this;return p.map(this.state.data,function(e,a){return n.a.createElement(W,{key:e.id,id:e.id,src:e.src,callback:t.callback})})}},{key:"render",value:function(){var t=this;return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("button",{onClick:function(e){t.saveAsset()}},"\u4fdd\u5b58")),n.a.createElement("div",null,this.getAssets()))}}]),e}(s.Component)),W=function(t){var e=t.id,a=t.src,s=t.callback;return n.a.createElement("div",{style:{width:"64px"}},n.a.createElement("img",{style:{width:"inherit"},src:a}),n.a.createElement("button",{onClick:function(){s.load(e)}},"Load"),n.a.createElement("button",{onClick:function(){s.delete(e)}},"Del"))},X=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).assets=[{id:1,type:"image",src:["./images/star_01.png"],tiltFlag:!0,anim:[{index:1,pos:{x:0,y:0},rot:0,scale:{x:1,y:1},time:0},{index:2,pos:{x:-100,y:100},rot:360,scale:{x:1,y:1},time:.5},{index:3,pos:{x:-100,y:200},rot:180,scale:{x:1,y:1},time:1},{index:4,pos:{x:100,y:0},rot:200,scale:{x:1,y:1},time:1.5},{index:5,pos:{x:-100,y:-200},rot:360,scale:{x:1,y:1},time:2},{index:6,pos:{x:0,y:100},rot:180,scale:{x:1,y:1},time:2.5},{index:7,pos:{x:0,y:0},rot:0,scale:{x:1,y:1},time:3}]},{id:2,type:"ani",src:["./images/arrow_left.png"],tiltFlag:!0,anim:[{index:1,pos:{x:0,y:0},rot:0,scale:{x:1,y:1},time:0},{index:2,pos:{x:10,y:0},rot:45,scale:{x:1,y:1},time:.5},{index:3,pos:{x:80,y:0},rot:90,scale:{x:1,y:1},time:1},{index:4,pos:{x:90,y:0},rot:95,scale:{x:1,y:1},time:1.5}]},{id:3,type:"ani",src:["./images/arrow_left.png"],tiltFlag:!1,anim:[{index:1,pos:{x:0,y:0},rot:0,scale:{x:1,y:1},time:0}]}],a.schedules=[{start:1,end:2,asset:1,position:{x:null,y:null}},{start:3,end:4,asset:2,position:{x:null,y:null}},{start:5,end:6,asset:3,position:{x:null,y:null}}],a.state={video:null,canvas:null,overlay:null,result:null,landmarks:null,positions:null,anies:[],editMode:!0,data:{assetId:1,rate:{},bool:{}}},a.partsConfig={base:O.leftEye,vector:O.rightEye},a.overlay=null,a.schedule=new I,p.each(a.schedules,function(t){a.schedule.setCallback({time:t.start,callback:function(){console.log("start",t.asset,t.start)}}),a.schedule.setCallback({time:t.end,callback:function(){console.log("end",t.asset,t.end)}})}),a.schedule.start(),a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"setCanvas",value:function(t){this.state.canvas!==t&&t&&this.setState({canvas:t})}},{key:"setVideo",value:function(t){this.state.video!==t&&t&&this.setState({video:t})}},{key:"setOverlay",value:function(t){this.state.overlay!==t&&t&&(this.setState({overlay:t}),this.initCanvas())}},{key:"initCanvas",value:function(){this.state.canvas&&this.state.overlay&&this.setState({width:x.width,height:x.height})}},{key:"render",value:function(){var t=this;return n.a.createElement("div",{className:"App"},n.a.createElement(F,{size:x,interval:w,video:function(e){t.setVideo(e)},canvas:function(e){t.setCanvas(e)}}),n.a.createElement(g,{canvas:this.state.canvas,video:this.state.video,interval:w,result:function(e){var a=d.getMediaDimensions(t.state.video),s=a.width,n=a.height,i=[e].map(function(t){return t.forSize(s,n)}),r=function(t){var e=t.getJawOutline();return{nose:t.getNose(),mouth:t.getMouth(),leftEye:t.getLeftEye(),rightEye:t.getRightEye(),leftEyeBrow:t.getLeftEyeBrow(),rightEyeBrow:t.getRightEyeBrow(),jawOutline:e}}(i[0].faceLandmarks);t.setState({landmarks:r,positions:i[0].landmarks.positions})}}),n.a.createElement(N,{assets:this.assets,progress:function(t){console.log("progress ",t)},done:function(){t.schedule.start()},view:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(R,{showEyes:!1,showPoints:!1,editMode:t.state.editMode,multiPoints:!1,editCallback:function(e){console.log("edit  callback ",e);var a=t.state.data;a.bool=e.bool,a.rate=e.rate,a.assetId=e.assetId,t.setState({data:a})},video:t.state.video,setRef:function(e){t.setOverlay(e)},partsConfig:t.partsConfig,landmarks:t.state.landmarks,positions:t.state.positions,anies:e,loadData:t.state.data}))}}),n.a.createElement("button",{onClick:function(){t.schedule.isPlay?t.schedule.pause():t.schedule.restart()}},"play/stop"),n.a.createElement("button",{onClick:function(){t.setState({editMode:!t.state.editMode})}},"editMode"),n.a.createElement(J,{editMode:this.state.editMode,assets:this.assets,callback:function(e){var a=p.clone(t.state.data);a.assetId=e,t.setState({data:a})}}),n.a.createElement(U,{assets:this.assets,currentAsset:this.state.data,callback:function(e){t.setState({data:e})}}))}}]),e}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[257,2,1]]]);
//# sourceMappingURL=main.c2dd0ad3.chunk.js.map